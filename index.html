<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>JVAV</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap');

    /* CSS Reset */
    * {
      box-sizing: border-box;
    }

    html {
      background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
    }

    body {
      margin: 0;
      font-family: 'Share Tech Mono', monospace;
      background: transparent;
      /* Allow Saturn to show through */
      color: #cfd8dc;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
      padding: 2rem;
      overflow-y: auto;
    }

    .container {
      max-width: 960px;
      width: 100%;
      background: rgba(16, 32, 39, 0.7);
      /* More transparent to see Saturn */
      padding: 2rem;
      border-radius: 12px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3), 0 0 20px #00ffff44;
      text-align: left;
      border: 1px solid rgba(0, 255, 255, 0.1);
      backdrop-filter: blur(5px);
      /* Less blur for more visibility */
      position: relative;
      z-index: 1;
      margin-top: 60px;
      animation: fadeIn 1.5s ease-in-out;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    h1 {
      font-size: 3rem;
      margin-bottom: 0.5rem;
      color: #00ffff;
      text-shadow: 0 0 10px #00ffff;
      text-align: center;
    }

    h2 {
      font-size: 1rem;
      margin-bottom: 2rem;
      color: #b0bec5;
      text-align: center;
      border-bottom: 1px solid #00ffff44;
      padding-bottom: 0.5rem;
    }

    section {
      margin-bottom: 2rem;
      padding: 1rem;
      border-left: 4px solid #00ffea;
      background: rgba(0, 255, 255, 0.05);
      transition: all 0.3s ease;
    }

    section:hover {
      background: rgba(0, 255, 255, 0.1);
      box-shadow: 0 0 15px #00ffff22;
    }

    a {
      color: #00ffff;
      text-decoration: none;
      transition: color 0.3s;
    }

    a:hover {
      color: #ffff00;
      text-shadow: 0 0 5px #ffff00;
    }

    /* Menu Bar */
    .menu-bar {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background: rgba(0, 255, 255, 0.15);
      backdrop-filter: blur(10px);
      height: 50px;
      display: flex;
      align-items: center;
      padding: 0 1rem;
      box-shadow: 0 2px 8px rgba(0, 255, 255, 0.2);
      z-index: 1000;
    }

    .menu-bar .menu-button {
      background: none;
      border: 2px solid #00ffff;
      color: #00ffff;
      padding: 0.2rem 0.8rem;
      font-family: 'Share Tech Mono', monospace;
      font-size: 1rem;
      cursor: pointer;
      border-radius: 4px;
      transition: background-color 0.3s ease, transform 0.1s ease;
    }

    .menu-bar .menu-button:hover {
      background-color: #00ffff33;
    }

    .menu-dropdown {
      position: fixed;
      top: 50px;
      left: 1rem;
      background: rgba(15, 32, 39, 0.95);
      border: 1px solid #00ffff;
      border-radius: 6px;
      box-shadow: 0 0 10px #00ffffcc;
      display: none;
      flex-direction: column;
      padding: 0.5rem;
      z-index: 1001;
      min-width: 160px;
    }

    .menu-dropdown a {
      color: #00ffff;
      text-decoration: none;
      padding: 0.5rem 1rem;
      font-family: 'Share Tech Mono', monospace;
      border-radius: 4px;
      transition: background-color 0.3s ease;
      display: block;
    }

    .menu-dropdown a:hover {
      background-color: #00ffff44;
    }
  </style>
  <script>
    function toggleMenu() {
      const dropdown = document.getElementById('menuDropdown');
      dropdown.style.display = dropdown.style.display === 'flex' ? 'none' : 'flex';
    }
    document.addEventListener('click', function (event) {
      const dropdown = document.getElementById('menuDropdown');
      const button = document.getElementById('menuButton');
      if (!button.contains(event.target) && !dropdown.contains(event.target)) {
        dropdown.style.display = 'none';
      }
    });
  </script>
</head>

<body>
  <!-- Saturn Background Container -->
  <div id="saturn-container"
    style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; pointer-events: none;"></div>

  <div class="menu-bar">
    <button id="menuButton" class="menu-button" onclick="toggleMenu()">菜单</button>

    <!-- Online Counter UI -->
    <div
      style="float: right; color: #00ff00; font-family: 'Share Tech Mono', monospace; font-size: 0.9rem; padding: 5px 15px; display: flex; align-items: center; gap: 8px;">
      <div id="online-indicator"
        style="width: 8px; height: 8px; background: #00ff00; border-radius: 50%; box-shadow: 0 0 5px #00ff00;"></div>
      <span>ONLINE: <span id="online-count-value">1</span></span>
    </div>

    <div id="menuDropdown" class="menu-dropdown">
      <a href="index.html" class="hacker-text" data-value="首页 / HOME">首页</a>
      <a href="about.html" class="hacker-text" data-value="关于 / ABOUT">关于</a>
      <a href="contact.html" class="hacker-text" data-value="联系 / CONTACT">联系</a>
      <a href="#" class="hacker-text" data-value="帮助 / HELP">帮助</a>
    </div>
  </div>


  <!-- ... (rest of simple content) ... -->

  <!-- DEPENDENCIES & SCRIPTS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.3/chess.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.min.js"></script>
  <script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>

  <script src="live_canvas.js"></script>
  <script src="saturn_bg.js"></script> <!-- Restored Background -->
  <script src="presence.js"></script> <!-- New Presence Script -->
  <script src="chess_game.js"></script>
  <script src="shooter_game.js"></script>

  <div class="container">
    <header>
      <h1 class="hacker-text" data-value="JVAV">JVAV</h1>
      <div id="danmaku-stage"
        style="width: 100%; height: 120px; position: relative; overflow: hidden; margin-bottom: 10px; border-top: 1px solid #00ffff22; border-bottom: 1px solid #00ffff22;">
      </div>
      <div style="text-align: center; margin-bottom: 15px; display: flex; justify-content: center; gap: 10px;">
        <input type="text" id="danmaku-input" placeholder="发送实时弹幕 (Max 10字)" maxlength="10"
          style="background: rgba(0,0,0,0.5); border: 1px solid #00ffff; color: #00ffff; padding: 5px 10px; border-radius: 4px; font-family: 'Share Tech Mono'; width: 250px;">
        <button id="btn-send-danmaku"
          style="background: #00ffff; color: #000; border: none; padding: 5px 15px; border-radius: 4px; cursor: pointer; font-family: 'Share Tech Mono'; font-weight: bold;">SEND</button>
      </div>
    </header>
    <main>
      <!-- ARTICLE FEED (Local JSON + Markdown) -->
      <style>
        /* Premium Article Typography */
        .article-entry {
          background: rgba(0, 0, 0, 0.2);
          border: 1px solid #00ffff22;
          border-radius: 8px;
          padding: 20px;
          margin-bottom: 20px;
        }

        .article-content {
          font-size: 0.95rem;
          line-height: 1.8;
          color: #d0d0d0;
        }

        .article-content h1,
        .article-content h2,
        .article-content h3 {
          color: #00ffff;
          margin-top: 1.5em;
          margin-bottom: 0.8em;
        }

        .article-content p {
          margin-bottom: 1em;
        }

        .article-content li {
          margin-bottom: 0.5em;
        }

        .article-content blockquote {
          border-left: 3px solid #ff00ff;
          margin: 1em 0;
          padding-left: 1em;
          color: #ff00ff;
          background: rgba(255, 0, 255, 0.05);
          padding: 10px;
        }

        .article-content code {
          background: rgba(0, 0, 0, 0.5);
          padding: 2px 5px;
          border-radius: 3px;
          font-family: monospace;
          color: #ffff00;
        }

        .article-content pre {
          background: #000;
          border: 1px solid #333;
          padding: 15px;
          border-radius: 5px;
          overflow-x: auto;
        }

        .article-content pre code {
          background: none;
          padding: 0;
          color: #0f0;
        }

        .article-content img {
          max-width: 100%;
          border-radius: 5px;
          border: 1px solid #333;
          margin: 10px 0;
        }
      </style>

      <div id="article-feed">
        <section>Loading Articles...</section>
      </div>
      <!-- Markdown Parser -->
      <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

      <script>
        // Micro-CMS Loader (JSON Mode)
        // Added timestamp to bypass browser cache
        fetch('articles.json?t=' + new Date().getTime())
          .then(response => response.json())
          .then(data => {
            const feed = document.getElementById('article-feed');
            feed.innerHTML = '';

            data.forEach(article => {
              const section = document.createElement('div');
              section.className = 'article-entry';

              const h2 = document.createElement('h2');
              h2.style.color = '#00ffff';
              h2.style.marginTop = '0';
              h2.style.borderBottom = '1px solid #00ffff44';
              h2.style.paddingBottom = '10px';
              h2.style.fontSize = '1.4rem';
              h2.innerHTML = `${article.title} <span style="font-size:0.8rem; float:right; color:#666; font-weight:normal">${article.date || ''}</span>`;

              const content = document.createElement('div');
              content.className = 'article-content';
              // Parse Markdown content
              content.innerHTML = marked.parse(article.content);

              section.appendChild(h2);
              section.appendChild(content);
              feed.appendChild(section);
            });
          })
          .catch(err => {
            console.error('CMS Error:', err);
            document.getElementById('article-feed').innerHTML = '<section style="color:red">Failed to load articles.json</section>';
          });
      </script>

      <!-- LIVE PLAYGROUND -->
      <section id="live-playground-section" style="display: block; border-left: none; padding-bottom: 2rem;">
        <h2 class="hacker-text" data-value="> 实时互动画布 / LIVE CANVAS"
          style="display: block; color: #ff00ff; margin-top: 0; margin-bottom: 10px; font-size: 1.5rem; border-bottom: 1px solid #ff00ff44; padding-bottom: 10px;">
          > 实时互动画布 / LIVE CANVAS</h2>
        <p style="font-size: 0.9rem; color: #ff00ffaa; margin-bottom: 10px;">> 在这里移动鼠标或绘画，其他在线用户都能实时看到！(无需登录)</p>
        <div id="live-canvas-container" style="width: 100%; height: 300px; position: relative;"></div>
      </section>



      <!-- CHAT ROOM -->
      <section style="display: block; height: auto; padding-top: 1rem; padding-bottom: 1rem;">
        <h2 class="hacker-text" data-value="> 公共频道 / CHAT ROOM"
          style="display: block; color: #00ffff; margin-top: 0; margin-bottom: 20px; font-size: 1.5rem; border-bottom: 1px solid #00ffff44; padding-bottom: 10px;">
          > 公共频道 / CHAT ROOM</h2>
        <div
          style="max-height: 600px; overflow-y: auto; padding-right: 10px; border: 1px solid #00ffff22; border-radius: 8px; background: rgba(0,0,0,0.2);">
          <script src="https://giscus.app/client.js" data-repo="J-x-Z/jvav" data-repo-id="R_kgDOQT6TSA"
            data-category="General" data-category-id="DIC_kwDOQT6TSM4CzjJh" data-mapping="pathname" data-strict="0"
            data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="dark_dimmed"
            data-lang="zh-CN" crossorigin="anonymous" async></script>
        </div>
      </section>

      <!-- GAME CENTER (Chess) -->
      <section id="game-section" style="display: block; border-left: none; padding-bottom: 2rem;">
        <h2 class="hacker-text" data-value="> 游戏大厅 / GAME CENTER"
          style="display: block; color: #ffff00; margin-top: 0; margin-bottom: 10px; font-size: 1.5rem; border-bottom: 1px solid #ffff0044; padding-bottom: 10px;">
          > 游戏大厅 / GAME CENTER</h2>
        <div style="display: flex; flex-wrap: wrap; gap: 20px; justify-content: center;">
          <!-- International Chess -->
          <div
            style="background: rgba(0,0,0,0.3); padding: 10px; border-radius: 4px; border: 1px solid #ffff0044; width: 340px; box-sizing: border-box;">
            <h3 style="color: #ffff00; margin: 0 0 10px 0; text-align: center;">国际象棋 (International Chess)</h3>
            <div id="board-chess" style="width: 300px; margin: 0 auto;"></div>
            <div id="status-chess" style="color: #ccc; font-size: 0.8rem; margin-top: 5px; text-align: center;">
              Waiting...</div>
            <div style="text-align: center; margin-top: 10px;">
              <button id="btn-chess-sit-w" style="font-size: 0.8rem;">Play White</button>
              <button id="btn-chess-sit-b" style="font-size: 0.8rem;">Play Black</button>
            </div>
          </div>
          <!-- Chinese Chess -->
          <div
            style="background: rgba(0,0,0,0.3); padding: 10px; border-radius: 4px; border: 1px solid #ff440044; width: 340px; box-sizing: border-box;">
            <h3 style="color: #ff4400; margin: 0 0 10px 0; text-align: center;">中国象棋 (Xiangqi)</h3>
            <div id="board-xiangqi"
              style="width: 300px; height: 340px; margin: 0 auto; position: relative; background: #dcb35c; border: 2px solid #5a3c18;">
            </div>
            <div id="status-xiangqi" style="color: #ccc; font-size: 0.8rem; margin-top: 5px; text-align: center;">
              Waiting...</div>
            <div style="text-align: center; margin-top: 10px;">
              <button id="btn-xiangqi-sit-r" style="font-size: 0.8rem;">Play Red</button>
              <button id="btn-xiangqi-sit-b" style="font-size: 0.8rem;">Play Black</button>
              <button id="btn-xiangqi-reset" style="font-size: 0.8rem;">Reset Board</button>
            </div>
          </div>
        </div>
      </section>

      <!-- SHOOTER GAME -->
      <section id="shooter-section" style="display: block; border-left: none; padding-bottom: 2rem;">
        <h2 class="hacker-text" data-value="> 乱斗竞技场 / BATTLE ARENA"
          style="display: block; color: #ff00ff; margin-top: 0; margin-bottom: 10px; font-size: 1.5rem; border-bottom: 1px solid #ff00ff44; padding-bottom: 10px;">
          > 乱斗竞技场 / BATTLE ARENA</h2>
        <div style="text-align: center;">
          <div id="shooter-container"
            style="position: relative; width: 100%; max-width: 800px; height: 400px; margin: 0 auto; background: #000; border: 2px solid #ff00ff; overflow: hidden;">
            <canvas id="shooter-canvas" width="800" height="400"
              style="display: block; width: 100%; height: 100%;"></canvas>
            <div id="shooter-overlay"
              style="position: absolute; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.7); display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 10;">
              <h3 style="color: #ff00ff; font-family: 'Share Tech Mono'; font-size: 2rem; margin: 0;">NEON BATTLE</h3>
              <p style="color: #fff; margin: 10px 0;">WASD to Move | Mouse to Aim & Shoot</p>
              <button id="btn-join-shooter"
                style="padding: 10px 30px; font-size: 1.2rem; background: #ff00ff; color: #fff; border: none; font-family: 'Share Tech Mono'; cursor: pointer; margin-top: 10px;">JOIN
                GAME</button>
              <div id="shooter-status" style="color: #ccc; margin-top: 10px; font-size: 0.8rem;">Online Players: 0</div>
            </div>
            <div id="shooter-hud"
              style="position: absolute; top: 10px; left: 10px; z-index: 5; display: none; pointer-events: none;">
              <div style="color: #fff; font-size: 1.2rem;">HP: <span id="shooter-hp" style="color: #0f0;">100</span>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- PLATFORMER GAME -->
      <section id="platformer-section" style="display: block; border-left: none; padding-bottom: 2rem;">
        <h2 class="hacker-text" data-value="> 乱斗竞技场 II / SMASH ARENA"
          style="display: block; color: #ff00ff; margin-top: 0; margin-bottom: 10px; font-size: 1.5rem; border-bottom: 1px solid #ff00ff44; padding-bottom: 10px;">
          > 乱斗竞技场 II / SMASH ARENA</h2>
        <div style="text-align: center;">
          <div id="platformer-container"
            style="position: relative; width: 100%; max-width: 800px; height: 400px; margin: 0 auto; background: #000; border: 2px solid #ff00ff; overflow: hidden;">
            <canvas id="platformer-canvas" width="800" height="400"
              style="display: block; width: 100%; height: 100%;"></canvas>
            <div id="platformer-overlay"
              style="position: absolute; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.7); display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 10;">
              <h3 style="color: #ff00ff; font-family: 'Share Tech Mono'; font-size: 2rem; margin: 0;">SMASH ARENA</h3>
              <p style="color: #fff; margin: 10px 0;">WASD/Space to Jump | Click to Shoot</p>
              <button id="btn-join-platformer"
                style="padding: 10px 30px; font-size: 1.2rem; background: #ff00ff; color: #fff; border: none; font-family: 'Share Tech Mono'; cursor: pointer; margin-top: 10px;">JOIN
                GAME</button>
              <div id="platformer-status" style="color: #ccc; margin-top: 10px; font-size: 0.8rem;">Online Players: 0
              </div>
            </div>
            <div id="platformer-hud"
              style="position: absolute; top: 10px; left: 10px; z-index: 5; display: none; pointer-events: none;">
              <div style="color: #fff; font-size: 1.2rem;">HP: <span id="platformer-hp" style="color: #0f0;">100</span>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- MINESWEEPER SECTION -->
      <section id="minesweeper-section" style="margin-top: 50px;">
        <!-- Game renders here -->
      </section>



      <footer style="text-align: center; padding: 20px; border-top: 1px solid #333; margin-top: 20px;">
        <p>&copy; 2025 JVAV. All rights reserved.</p>
        <!-- Visitor Counter -->
        <div style="font-size: 0.8rem; color: #666; margin-top: 5px;">
          <span id="busuanzi_container_site_pv" style="display:none">
            VISITS: <span id="busuanzi_value_site_pv" style="color: #00ffff;"></span>
          </span>
        </div>
      </footer>
  </div>

  <!-- DEPENDENCIES & SCRIPTS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.3/chess.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.min.js"></script>
  <script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>

  <script src="live_canvas.js"></script>
  <script src="presence.js"></script> <!-- Real-time Counter -->
  <script src="chess_game.js"></script>
  <script src="shooter_game.js"></script>
  <script src="platformer_game.js"></script>
  <script src="minesweeper.js"></script> <!-- New Minesweeper Script -->


  <script>
    // Initialize All Games
    window.addEventListener('load', () => {
      // Init Saturn Background
      try {
        if (typeof SaturnBackground !== 'undefined') {
          new SaturnBackground('saturn-container');
          console.log('SaturnBackground initialized.');
        } else {
          console.error('SaturnBackground class not found. Check saturn_bg.js.');
        }
      } catch (e) { console.error('Saturn Init Error:', e); }

      try {
        window.ChessGameManager ? new window.ChessGameManager() : console.warn('Chess not loaded');
      } catch (e) { console.error('Chess Init Error:', e); }

      try {
        // Only init if canvas exists (it's dynamically hidden/shown in some versions, but here it's static)
        if (document.getElementById('shooter-canvas')) { // Changed to shooter-canvas
          window.ShooterGame ? new window.ShooterGame('shooter-canvas') : console.warn('Shooter not loaded'); // Changed to shooter-canvas
        }
      } catch (e) { console.error('Shooter Init Error:', e); }

      try {
        if (document.getElementById('platformer-canvas')) { // Changed to platformer-canvas
          window.PlatformerGame ? new window.PlatformerGame('platformer-canvas') : console.warn('Platformer not loaded'); // Changed to platformer-canvas
        }
      } catch (e) { console.error('Platformer Init Error:', e); }

      try {
        // Init Live Canvas
        if (window.LiveCanvas) {
          new window.LiveCanvas('live-canvas-container'); // Changed to live-canvas-container
        }
      } catch (e) { console.error('LiveCanvas Init Error:', e); }

      try {
        // Init Minesweeper
        if (window.MinesweeperGame) {
          new window.MinesweeperGame('minesweeper-section');
        }
      } catch (e) { console.error('Minesweeper Init Error:', e); }
    });

    // Hacker Effect
    const letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
    document.querySelectorAll(".hacker-text").forEach(element => {
      // Mouseover event
      element.onmouseover = event => {
        let iteration = 0;
        clearInterval(event.target.interval);

        event.target.interval = setInterval(() => {
          event.target.innerText = event.target.innerText
            .split("")
            .map((letter, index) => {
              if (index < iteration) {
                return event.target.dataset.value[index];
              }
              return letters[Math.floor(Math.random() * 26)];
            })
            .join("");

          if (iteration >= event.target.dataset.value.length) {
            clearInterval(event.target.interval);
          }

          iteration += 1 / 3;
        }, 30);
      }

      // Touch event (mobile support)
      element.addEventListener("touchstart", (event) => {
        let iteration = 0;
        clearInterval(event.target.interval);

        event.target.interval = setInterval(() => {
          event.target.innerText = event.target.innerText
            .split("")
            .map((letter, index) => {
              if (index < iteration) {
                return event.target.dataset.value[index];
              }
              return letters[Math.floor(Math.random() * 26)];
            })
            .join("");

          if (iteration >= event.target.dataset.value.length) {
            clearInterval(event.target.interval);
          }

          iteration += 1 / 3;
        }, 30);
      });
    });
  </script>
</body>

</html>
```